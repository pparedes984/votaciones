/*
 * File: app/view/pnlClavesViewController.js
 *
 * This file was generated by Sencha Architect version 4.2.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 6.6.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 6.6.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('voto.view.pnlClavesViewController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.pnlclaves',

    onPanelAfterRender: function(component, eOpts) {

    },

    onId_clavesClick: function(button, e, eOpts) {
        Ext.Ajax.request({
            url: '../servidor/voto/votante/generarClave',
            method:"post",
            success: function( result, request ) {
                Ext.Ajax.request({
                    url: '../servidor/voto/votante/clavespendientes',
                    method:"post",
                    success: function( result, request ) {
                        var obj = Ext.JSON.decode(result.responseText);
                        Ext.getCmp('id_pendientes_claves').setValue(obj.data);
                        if(obj.data>0)
                        {
                            Ext.getCmp('id_claves').setDisabled(false);
                            Ext.getCmp('id_aviso_clave').setText('');
                        }
                        else{
                            Ext.getCmp('id_claves').setDisabled(true);
                            Ext.getCmp('id_aviso_clave').setText('No existen claves pendientes por generar.');

                        }
                    },

                    failure: function(response, opts) {
                        console.log('server-side failure with status code ' + response.status);
                    }
                });
            },

            failure: function(response, opts) {
                console.log('server-side failure with status code ' + response.status);
            }
        });
    },

    onPanelAfterRender: function(component, eOpts) {
        Ext.Ajax.request({
            url: '../servidor/voto/votante/clavespendientes',
            method:"post",
            success: function( result, request ) {
                var obj = Ext.JSON.decode(result.responseText);
                Ext.getCmp('id_pendientes_claves').setValue(obj.data);
                if(obj.data>0)
                {
                    Ext.getCmp('id_claves').setDisabled(false);
                    Ext.getCmp('id_aviso_clave').setText('');
                }
                else{
                    Ext.getCmp('id_claves').setDisabled(true);
                    Ext.getCmp('id_aviso_clave').setText('No existen claves pendientes por generar.');

                }
            },

            failure: function(response, opts) {
                console.log('server-side failure with status code ' + response.status);
            }
        });
    }

});
